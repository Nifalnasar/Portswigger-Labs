## Question:

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/ca1ed15c-7114-48ea-b7ec-4d05293b9d8e)

## Solution:

Go to My-Account and Log In to the account with the above credentials and change your email address.

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/89f49244-ba4c-4126-8a68-0ad78c98d5ca)

Send the POST /my-account/change-email request to Burp Repeater.And Study the ```POST``` /my-account/change-email request and notice that this doesn't contain any unpredictable tokens so may be vulnerable to CSRF if you can bypass the ```SameSite``` cookie restrictions.

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/a3105c8b-486d-4caa-8d5c-6edc5f249f86)

Look at the response to your ```POST /login``` request. Notice that the website doesn't explicitly specify any SameSite restrictions when setting session cookies. As a result, the browser will use the default ```Lax``` restriction level.

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/43be6136-b412-4286-9761-856d00d7f1f0)

