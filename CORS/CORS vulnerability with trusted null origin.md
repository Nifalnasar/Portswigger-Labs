## Question:

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/512fb976-d429-4c90-959d-18ea6b101c7b)

## Solution:

Check intercept is off, then use Burp's browser to log in to your account. Click "My account".

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/c72e6f7e-7501-4fbf-96a6-ab5b8d0a975d)

Review the history and observe that your key is retrieved via an AJAX request to /accountDetails, and the response contains the Access-Control-Allow-Credentials header suggesting that it may support CORS.

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/cffc6110-75c0-49f9-b9da-8783a5a8aa94)

Send the request to Burp Repeater, and resubmit it with the added header `Origin: null`.

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/a54d7df8-257d-4988-a0e5-0c0aa07858c7)

Observe that the "null" origin is reflected in the Access-Control-Allow-Origin header.

In the browser, go to the exploit server and enter the following HTML, replacing YOUR-LAB-ID with the URL for your unique lab URL and YOUR-EXPLOIT-SERVER-ID with the exploit server ID:

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/4d511888-626f-42bb-9781-d093fef8794c)

Go back to the exploit server and click "Deliver exploit to victim".

Click "Access log", retrieve and submit the victim's API key to complete the lab.

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/319b11b2-1eb9-442e-8577-b7b6f38e85a9)

API key: `8jWJnnmXOWp8kDWXFwQJnTnQkBkpPzQS'

Lab Solved

![image](https://github.com/Nifalnasar/Portswigger-Labs/assets/141356053/1af06484-4be9-46d3-9f45-200692b1c8a8)




